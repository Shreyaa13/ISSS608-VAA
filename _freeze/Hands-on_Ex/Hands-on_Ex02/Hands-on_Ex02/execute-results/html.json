{
  "hash": "a67087639d8e888e31d1eeff550fbdb7",
  "result": {
    "markdown": "---\ntitle: \"Hands-on Ex 2 - Beyond ggplot2 Fundamentals\"\nauthor: \"Shreya Agarwal\"\ndate: \"23 January 2025\"\ndate-modified: \"last-modified\"\nexecute: \n  warning: false\n  message: false\n  freeze: true\n---\n\n\n## 2.1 Overview\n\nThis chapter introduces ggplot2 extensions for creating more elegant statistical graphics. We'll learn to:\n\n-   Place annotations effectively with the **ggrepel** package.\n-   Create publication-quality figures using **ggthemes** and **hrbrthemes**.\n-   Combine ggplot2 graphs into composite figures with the **patchwork** package.\n\n## 2.2 Getting started\n\n### 2.2.1 Installing and loading the required libraries\n\nIn this exercise, along with **tidyverse**, four R packages will be used:\n\n-   **ggrepel**: Adds geoms to prevent overlapping text labels in ggplot2.\n-   **ggthemes**: Offers extra themes, geoms, and scales for ggplot2.\n-   **hrbrthemes**: Focuses on typography-centric themes for ggplot2.\n-   **patchwork**: Facilitates combining ggplot2 plots into composite figures.\n\nThe code below checks if these packages are installed and loads them into the R environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork,\n               ggthemes, hrbrthemes,\n               tidyverse)\n```\n:::\n\n\n### 2.2.2 Importing data\n\nThis exercise uses a CSV file, *Exam_data*, containing year-end exam grades of a cohort of Primary 3 students from a local school.\n\nThe code below imports *exam_data.csv* into the R environment using the ***read_csv()*** function from the **readr** package, which is part of tidyverse.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexam_data <- read_csv(\"data/Exam_data.csv\")\n```\n:::\n\n\nThe exam_data tibble contains seven attributes: four categorical - ID, CLASS, GENDER, RACE and three continuous - MATHS, ENGLISH, SCIENCE.\n\n## 2.3 Beyond ggplot2 Annotation: ggrepel\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS,\n           y = ENGLISH)) + \n  geom_point() + \n  geom_smooth(method = lm,\n              size = 0.5) + \n  geom_label(aes(label = ID),\n             hjust = .5,\n             vjust = -.5) + \n  coord_cartesian(xlim = c(0,100),\n                  ylim = c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\nAnnotating graphs with many data points can be challenging. The **ggrepel** package extends ggplot2 by providing geoms to prevent overlapping text, as shown in the examples.\n\nWe simply replace **geom_text()** with **geom_text_repel()** or **geom_label()** with **geom_label_repel()**.\n\n### 2.3.1 Working with ggrepel\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS,\n           y = ENGLISH)) + \n  geom_point() + \n  geom_smooth(method = lm,\n              size = 0.5) + \n  geom_label_repel(aes(label = ID),\n                   fontface = \"bold\") + \n  coord_cartesian(xlim = c(0,100),\n                  ylim = c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\n## 2.4 Beyond ggplot2 Themes\n\n**ggplot2** includes eight built-in themes (e.g., *theme_gray(), theme_bw(), theme_minimal()*).\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  theme_gray() + \n  ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n:::\n\n### 2.4.1 Working with ggtheme package\n\n**ggthemes** package adds themes replicating plot styles from Tufte, Fivethirtyeight, The Economist, and more.\n\nIn the example below, the *Economist* theme is used. It also provides some extra geoms and scales for ‘ggplot2’.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  ggtitle(\"Distribution of Maths scores\") + \n  theme_economist()\n```\n:::\n\n:::\n\n### 2.4.2 Working with hrbrthemes package\n\nThe **hrbrthemes** package offers a base theme emphasizing typography, including label placement and font customization.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  ggtitle(\"Distribution of Maths scores\") + \n  theme_ipsum()\n```\n:::\n\n:::\n\n::: panel-tabset\n\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = exam_data,\n       aes(x = MATHS)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  ggtitle(\"Distribution of Maths scores\") + \n  theme_ipsum(axis_title_size = 18,\n              base_size = 15,\n              grid = \"Y\")\n```\n:::\n\n:::\n\nObservations from the code chunk above :\n\n-   axis_title_size: Sets the font size of axis titles to 18.\n-   base_size: Increases the default font size of axis labels to 15.\n-   grid: Removes x-axis grid lines.\n\n## 2.5 Beyond Single Graph\n\nTo tell a visual story, it's common to combine multiple graphs. This section shows how to create composite plots by combining multiple graphs. First, we generate three graphs using the code below.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(data = exam_data,\n       aes(x = MATHS)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  coord_cartesian(xlim = c(0,100)) + \n  ggtitle(\"Distribution of Maths scores\")\n```\n:::\n\n:::\n\nNext\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- ggplot(data = exam_data,\n       aes(x = ENGLISH)) + \n  geom_histogram(bins = 20,\n                 boundary = 100,\n                 color = \"grey25\",\n                 fill = \"grey90\") + \n  coord_cartesian(xlim = c(0,100)) + \n  ggtitle(\"Distribution of English scores\")\n```\n:::\n\n:::\n\nLastly, we draw a scatterplot for English score versus Maths score as shown below -\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(data = exam_data,\n       aes(x = MATHS,\n           y = ENGLISH)) + \n  geom_point() + \n  geom_smooth(method = lm,\n              size = 0.5) + \n  coord_cartesian(xlim = c(0,100),\n                  ylim = c(0,100)) + \n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n```\n:::\n\n:::\n\n### 2.5.1 Creating Composite Graphics: pathwork methods\n\nSeveral ggplot2 extensions functions, like *grid.arrange()* of **gridExtra** package and *plot_grid()* of **cowplot** package, combine graphs into composites. The **patchwork** package simplifies this with intuitive syntax:\n\n-   **+**: Two-column layout.\n-   **()**: Groups subplots.\n-   **/**: Two-row layout.\n\n### 2.5.2 Combining two ggplot2 graphs\n\nUsing very simple syntax, we can now create a composite of two histograms using patchwork.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2\n```\n:::\n\n:::\n\n### 2.5.3 Combining three ggplot2 graphs\n\nMore complex composites like the figure below is created using the operators:\n\n-   **/**: Stacks two ggplot2 plots.\n-   **\\|**: Places plots side by side.\n-   **()**: Defines the plotting sequence.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 / p2) | p3\n```\n:::\n\n:::\n\n### 2.5.4 Creating a composite figure with tag\n\npatchwork also provides auto-tagging properties to identify subplots in text.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\n((p1 / p2) | p3) +\n  plot_annotation(tag_levels = 'I')\n```\n:::\n\n:::\n\n### 2.5.5 Creating figure with inset\n\nThe patchwork package not only arranges plots side by side with layouts but also allows free placement of plots or graphic elements using **inset_element()**.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 + inset_element(p2,\n                   left = 0.02,\n                   bottom  = 0.7,\n                   right = 0.5,\n                   top = 1)\n```\n:::\n\n:::\n\n### 2.5.6 Creating a composite figure by using patchwork and ggtheme\n\nFigure below is created by combining patchwork and theme_economist() of ggthemes package discussed earlier.\n\n::: panel-tabset\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Hands-on_Ex02_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n## The code\n\n\n::: {.cell}\n\n```{.r .cell-code}\npatchwork <- (p1 / p2) | p3\npatchwork & theme_economist()\n```\n:::\n\n:::\n",
    "supporting": [
      "Hands-on_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}